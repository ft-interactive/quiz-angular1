<div class="o-grid-container">
  <div class="animate-reveal"
    ng-repeat="question in questions"
    ng-controller="QuestionCtrl"
    ng-show="$index <= questionsAnswered.value"
    ng-cloak>
    <div class="o-grid-row">
      <div data-o-grid-colspan="12 M8 L6 center">
        <h2 style="text-align: center">Question {{$index + 1}} of {{questions.length}}</h2>
      </div>
    </div>

    <div class="o-grid-row">
      <div data-o-grid-colspan="12 M8 L6 center">
        <h3 class="o-typography-header3" ng-bind-html="questions[$index].question"></h3>
      </div>
    </div>

    <div class="o-grid-row" style="margin-left: 0">
      <div data-o-grid-colspan="12 M8 center" class="background-image" style="background: url({{questions[$index].imgurl}}) {{questions[$index].imgoptions}}">
        <div class="answer-controls"
          ng-repeat="choice in choices[$index]">
          <button class="o-buttons o-buttons--big o-buttons--inverse"
            ng-click="submitAnswer()"
            ng-class="{
              remain: answerSubmitted && choice === userAnswer && choice === remainAnswer,
              leave: answerSubmitted && choice === userAnswer && choice === leaveAnswer,
              neither: answerSubmitted && choice === userAnswer && choice !== remainAnswer && choice !== leaveAnswer}"
            ng-disabled="answerSubmitted">
            {{choice}}
          </button>
        </div>
      </div> <!-- /data-o-grid-colspan -->
    </div> <!-- /o-grid-row -->

    <div class="o-grid-row">
      <div data-o-grid-colspan="12 M8 L6 center">
        <div class="o-typography-caption">
          {{questions[$index].imgcredit}}
        </div>
      </div>
    </div>

    <div class="o-grid-row animate-reveal"
      ng-show="answerSubmitted">
      <div data-o-grid-colspan="12 M8 L6 center">
        <div data-o-component="o-aside-panel" class="o-aside-panel">
          <div class="o-aside-panel__header">
            <h3 class="o-aside-panel__heading">More on this topic</h3>
          </div>

          <div class="o-aside-panel__body">
            <a href="{{questions[$index].linkurl}}" target="_blank">{{questions[$index].linktext}}</a>
          </div>
        </div>
        <div style="text-align: center">
          <i class="icon-arrow-down"></i>
        </div>
      </div> <!-- /data-o-grid-colspan -->
    </div>

    <div class="splash animate-splash"
      ng-class="{remain: isRemain, leave: isLeave}"
      ng-show="showSplash">
      <div class="o-big-number__title animate-splash"
        ng-show="answerSubmitted && isRemain">
        +1 Remain
      </div>

      <div class="o-big-number__title animate-splash"
        ng-show="answerSubmitted && isLeave">
        +1 Leave
      </div>

      <div class="o-big-number__title animate-splash"
        ng-show="answerSubmitted && !isRemain && !isLeave">
        +0
      </div>
    </div>
  </div> <!-- /ng-repeat -->

  <!-- Results -->
  <div ng-show="quizStatus.isOver">
    <div class="o-grid-row">
      <div data-o-grid-colspan="12 M8 L6 center">
        <h2 style="text-align: center">Your result</h2>
      </div>
    </div>
    <div class="o-grid-row">
      <div data-o-grid-colspan="12 S4 M4 L3 center">
        <div class="o-big-number o-big-number--standard">
          <div class="o-big-number__title">
            <div style="display: inline; float: left"
              ng-show="remainPercentage.value > 0"
              inc-dec-counter value="{{remainPercentage.value + 50}}" interval="5">
            </div>

            <div style="display: inline; float: left"
              ng-show="remainPercentage.value < 0"
              inc-dec-counter value="{{leavePercentage.value + 50}}" interval="5">
            </div>

            <div style="display: inline; width: 253px; text-align: left"
              ng-show="remainPercentage.value != 0">
              &#37;
            </div>

            <div style="text-align: left"
              ng-show="remainPercentage.value != 0">
              {{result.text}}!
            </div>

            <div style="font-size: 0.8em; text-align: left"
              ng-show="remainPercentage.value == 0">
              {{result.text}}!
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="o-grid-row">
      <div data-o-grid-colspan="12 M8 L6 center">
        <p ng-bind-html="message.content"></p>
      </div>
    </div>

    <div class="o-grid-row">
      <div data-o-grid-colspan="12 M8 L6 center" style="margin-top: 0.5em; margin-bottom: 0.8em; text-align: center">
        <div ng-if="remainPercentage.value > 0">
          <button class="o-buttons o-buttons--big o-buttons--standout tweet-score"
            ng-disabled="!quizStatus.isOver"
            socialshare
            socialshare-provider="twitter"
            socialshare-text="I'm leaning {{remainPercentage.value + 50}}&#37; towards #{{result.text}}. Take the FT #EUref quiz to see where you stand:"
            socialshare-url="https://ft.com/eu-referendum"
            socialshare-via="FT">
            <i class="fa fa-twitter"></i>

            Tweet Your Result
          </button>
        </div>

        <div ng-if="remainPercentage.value < 0">
          <button class="o-buttons o-buttons--big o-buttons--standout tweet-score"
            ng-disabled="!quizStatus.isOver"
            socialshare
            socialshare-provider="twitter"
            socialshare-text="I'm leaning {{leavePercentage.value + 50}}&#37; towards #{{result.text}}. Take the FT #EUref quiz to see where you stand:"
            socialshare-url="https://ft.com/eu-referendum"
            socialshare-via="FT">
            <i class="fa fa-twitter"></i>

            Tweet Your Result
          </button>
        </div>

        <div ng-if="remainPercentage.value == 0">
          <button class="o-buttons o-buttons--big o-buttons--standout tweet-score"
            ng-disabled="!quizStatus.isOver"
            socialshare
            socialshare-provider="twitter"
            socialshare-text="I'm still undecided! Take the FT #EUref quiz to see where you stand:"
            socialshare-url="https://ig.ft.com/sites/how-should-i-vote-in-the-eu-referendum/"
            socialshare-via="FT">
            <i class="fa fa-twitter"></i>

            Tweet Your Result
          </button>
        </div>
      </div>
    </div>

    <div class="o-grid-row">
      <div data-o-grid-colspan="12 M8 L6 center">
        <div data-o-component="o-aside-panel" class="o-aside-panel" style="margin-top: 4px">
          <div class="o-aside-panel__header">
            <h3 class="o-aside-panel__heading">Featured in this quiz</h3>
          </div>

          <div class="o-aside-panel__body">
            <ol style="font-size: 16px; font-weight: 400">
              <li ng-repeat="question in questions">
                <a href="{{question.linkurl}}" target="_blank">{{question.linktext}}</a>
              </li>
            </ol>
          </div>
        </div>
      </div>
    </div>
  </div> <!-- /ng-show -->
</div>

<script>if (cutsTheMustard) addScript('https://origami-build.ft.com/v2/bundles/js?modules=o-big-number@^1.1.3,', true, true)</script>
